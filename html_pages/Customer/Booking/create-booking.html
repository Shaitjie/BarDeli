<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BarDeli Booking </title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.24.0/dist/supabase.min.js"></script>
  <!--Font Awesome-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css"
    integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
 
  <style>
    /* Toast animation */
    #toast {
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
      pointer-events: none;
    }

    #toast.show {
      opacity: 1;
    }

  </style>
</head>

<body class="font-inter bg-gray-50">
    <!-- Toast Notification -->
    <div id="toast"
      class="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center">
      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
      </svg>
      <span id="toastMessage">Item saved to cart!</span>
    </div>
    <!-- Sidebar -->
    <nav class="fixed top-0 left-0 h-full w-56 bg-orange-600 flex flex-col justify-between py-6">
      <div>
        <div class="flex justify-center mb-6">
          <img src="../../../images/BarDeli Logo (White).png" class="h-24 w-auto" alt="Logo">
        </div>
        <div class="flex flex-col space-y-2">
          <a href="../customerhomepage.html"
            class="flex items-center gap-3 px-4 py-3 text-white font-bold rounded hover:bg-orange-500">
            <i class="fa-regular fa-house"></i>Home
          </a>
          <a href="../customerbookingpage.html"
            class="flex items-center gap-3 px-4 py-3 text-white font-bold rounded bg-orange-800">
            <i class="fa-regular fa-calendar"></i>Bookings
          </a>
          <a href="../customernotificationspage.html"
            class="flex items-center gap-3 px-4 py-3 text-white font-bold rounded hover:bg-orange-500">
            <i class="fa-regular fa-bell"></i>Notifications
          </a>
          <a href="../customerprofilepage.html"
            class="flex items-center gap-3 px-4 py-3 text-white font-bold rounded hover:bg-orange-500">
            <i class="fa-regular fa-user"></i>Profile
          </a>
        </div>
      </div>
      <div class="flex justify-center">
        <a href="../../../index.html"
          class="flex items-center gap-3 px-4 py-3 text-white font-bold rounded hover:bg-orange-500">
          <i class="fa-solid fa-arrow-right-from-bracket"></i> Logout
        </a>
      </div>
    </nav>
    <!-- Main Content -->
    <main class="ml-56 p-8 max-w-4xl">
      <h1 class="text-3xl font-extrabold text-orange-600 mb-8">New Booking</h1>

      <!-- Progress Bar -->
      <div class="mb-6">
        <div class="flex justify-between mb-1 text-sm font-medium text-gray-700">
          <span id="stepText">Step 1 of 5</span>
        </div>
        <div class="w-full bg-gray-300 rounded-full h-2">
          <div id="progressBar" class="bg-orange-600 h-2 rounded-full" style="width: 20%"></div>
        </div>
      </div>

      <form id="bookingForm" class="space-y-6"> 
        <!-- Step 1: Event Details & Guest Info -->
        <div class="step">
          <h2 class="text-xl font-bold mb-4">Event Details & Guest Info</h2>
          <div class="space-y-4">
            <input type="text" id="eventName" placeholder="Event Name"
              class="w-full p-3 rounded border border-gray-300">
            <input type="date" id="eventDate" class="w-full p-3 rounded border border-gray-300">
            <input type="time" id="eventTime" class="w-full p-3 rounded border border-gray-300">
            <select id="eventType" class="w-full p-3 rounded border border-gray-300">
              <option value="">Event Type</option>
              <option>Corporate</option>
              <option>Birthday</option>
              <option>Wedding</option>
              <option>Funeral</option>
              <option>Other</option>
            </select>
            <input type="number" id="guests" min="1" placeholder="Number of Guests"
              class="w-full p-3 rounded border border-gray-300">
            
            <!-- ✅ Address Input with Google Places -->
            <input type="text" id="address" placeholder="Event Location"
              class="w-full p-3 rounded border border-gray-300">
          </div>
          <div class="flex justify-end mt-6">
            <button type="button" onclick="nextStep()"
              class="px-6 py-3 bg-orange-600 text-white font-bold rounded hover:bg-orange-500">Next</button>
          </div>
        </div>

        <!-- Step 2: Menu Selection -->
        <div class="step hidden">
          <h2 class="text-xl font-bold mb-4">Menu Selection</h2>
          <div id="menuList" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Menu items dynamically loaded -->
          </div>
          <div class="flex justify-between mt-6">
            <button type="button" onclick="prevStep()"
              class="px-6 py-3 bg-gray-300 text-gray-700 font-bold rounded hover:bg-gray-200">Back</button>
            <button type="button" onclick="nextStep()"
              class="px-6 py-3 bg-orange-600 text-white font-bold rounded hover:bg-orange-500">Next</button>
          </div>
        </div>

        <!-- Menu Image Modal -->
        <div id="menuImageModal" class="hidden fixed inset-0 bg-black bg-opacity-50 justify-center items-center z-50">
          <div class="bg-white rounded-lg p-4 max-w-lg w-full relative">
            <button type="button" id="closeMenuImageModal" class="absolute top-2 right-2 text-gray-600 hover:text-black">✖</button>
            <img id="menuImageDisplay" src="" alt="Menu Image" class="w-full h-auto rounded-lg" />
          </div>
        </div>


        <!-- Step 3: Extras & Services -->
        <div class="step hidden">
          <h2 class="text-xl font-bold mb-4">Extras & Services</h2>
          <div id="extrasList" class="space-y-2">
            <!-- Extra items dynamically loaded (with checkboxes) -->
          </div>
          <div class="flex justify-between mt-6">
            <button type="button" onclick="prevStep()"
              class="px-6 py-3 bg-gray-300 text-gray-700 font-bold rounded hover:bg-gray-200">Back</button>
            <button type="button" onclick="nextStep()"
              class="px-6 py-3 bg-orange-600 text-white font-bold rounded hover:bg-orange-500">Next</button>
          </div>
        </div>

        <!-- Step 4: Summary -->
        <div class="step hidden">
          <h2 class="text-xl font-bold mb-4">Summary</h2>
          <div id="summaryDetails" class="space-y-2 border p-4 rounded max-h-180"></div>
          <div class="flex justify-between mt-6">
            <button type="button" onclick="prevStep()"
              class="px-6 py-3 bg-gray-300 text-gray-700 font-bold rounded hover:bg-gray-200">Back</button>
            <button type="button" onclick="nextStep()"
              class="px-6 py-3 bg-orange-600 text-white font-bold rounded hover:bg-orange-500">Next</button>
          </div>
        </div>

        <!-- Step 5: Payment Upload -->
        <div class="step hidden">
          <h2 class="text-xl font-bold mb-4">Payment Upload</h2>
          <div id="paymentSummary" class="space-y-2 border p-4 rounded mb-4">
            <p><strong>Total:</strong> R<span id="totalAmount">0.00</span></p>
            <p><strong>Deposit (50%):</strong> R<span id="depositAmount">0.00</span></p>
            <p><strong>Bank Details:</strong> Account Number: 123456789, Bank: XYZ Bank</p>
            <p><strong class="underline">Proof of Payments (POPs) may be pdf files or images</strong></p>
          </div>
          <input type="file" id="paymentProof" class="w-full p-3 border border-gray-300 rounded mb-4">
          <div class="flex justify-between mt-6">
            <button type="button" onclick="prevStep()"
              class="px-6 py-3 bg-gray-300 text-gray-700 font-bold rounded hover:bg-gray-200">Back</button>
            <button type="submit"
              class="px-6 py-3 bg-orange-600 text-white font-bold rounded hover:bg-orange-500">Submit
              Booking</button>
          </div>
        </div>
      </form>
    </main>
    
    <!-- Custom Menu Modal -->
    <div id="customMenuModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
      <div class="bg-white w-11/12 md:w-3/4 lg:w-1/2 max-h-[80vh] overflow-y-auto rounded-2xl shadow-lg p-6 relative">
        <h2 class="text-xl font-bold mb-4">Custom Menu Selection</h2>
        <div id="customMenuContent"></div>
        <div class="flex justify-end mt-6 space-x-3">
          <button type="button" id="closeCustomMenu" class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-200">Cancel</button>
          <button type="button" id="saveCustomMenu" class="px-4 py-2 bg-orange-600 text-white rounded hover:bg-orange-500">Save</button>
        </div>
      </div>
    </div>

    <!-- Google Places API -->
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB8ejcAGMuCtZ2lkyhw6l8G0lJ54d_WzXI&libraries=places&region=ZA&language=en&callback=initAutocomplete"
      async defer>
    </script>

    <script>
      function initAutocomplete() {
        const input = document.getElementById("address");
        if (!input) return;

        const autocomplete = new google.maps.places.Autocomplete(input, {
          types: ["address"],
          componentRestrictions: { country: "za" },
        });
        autocomplete.setFields(["address_components", "formatted_address"]);

        autocomplete.addListener("place_changed", () => {
          const place = autocomplete.getPlace();
          if (!place.formatted_address) return;
          input.value = place.formatted_address;
        });
      }
    </script>

    <style>
    
      .pac-container { z-index: 10000 !important; }
    </style>

    <script type="module" src="./Create-booking.js"></script>

  </body>
</html>
